#include "fir.h"

Fir::Fir(QObject *parent) : QObject(parent)
{

}

QVector<int> Fir::set_filter(QVector<int> wave, FILTER l)
{
    if(l == NONE){
        return wave;
    }

    if(l == lp_100Hz){
        QVector<int> zero;
        zero.fill(0,16);
        wave.append(zero);
        wave = set_filter_origin(wave,l);
        return wave.mid(8,wave.count()-16);
    }

    QVector<int> zero;
    zero.fill(0,256);
    wave.append(zero);
    wave = set_filter_origin(wave,l);
    return wave.mid(128,wave.count()-256);
}

QVector<float> Fir::set_filter_origin(QVector<float> wave, FILTER l)
{
    switch (l) {
    case hp_500k:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_500k ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M5:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M5 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M8:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M8 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_2M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_2M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_2M5:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_2M5 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_3M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_3M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_5M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_5M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_8M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_8M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_10M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_10M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_12M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_12M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_15M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_15M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_18M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_18M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_20M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_20M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_22M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_22M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_25M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_25M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_28M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_28M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_30M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_30M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_32M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_32M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_35M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_35M ((float)wave [i], (float)wave [i], !i);
        }
        break;


    case lp_100Hz:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_100Hz((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_2M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_2M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_5M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_5M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_8M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_8M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_10M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_10M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_12M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_12M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_15M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_15M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_18M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_18M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_20M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_20M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_22M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_22M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_25M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_25M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_28M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_28M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_30M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_30M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_32M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_32M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_35M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_35M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_38M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_38M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_40M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_40M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    default:
        break;
    }
    return wave;
}

QVector<int> Fir::set_filter_origin(QVector<int> wave, FILTER l)
{
    switch (l) {
    case hp_500k:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_500k ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M5:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M5 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_1M8:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_1M8 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_2M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_2M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_2M5:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_2M5 ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_3M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_3M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_5M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_5M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_8M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_8M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_10M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_10M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_12M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_12M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_15M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_15M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_18M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_18M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_20M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_20M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_22M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_22M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_25M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_25M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_28M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_28M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_30M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_30M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_32M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_32M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case hp_35M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_hp_35M ((float)wave [i], (float)wave [i], !i);
        }
        break;


    case lp_100Hz:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_100Hz((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_2M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_2M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_5M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_5M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_8M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_8M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_10M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_10M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_12M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_12M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_15M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_15M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_18M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_18M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_20M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_20M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_22M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_22M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_25M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_25M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_28M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_28M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_30M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_30M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_32M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_32M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_35M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_35M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_38M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_38M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    case lp_40M:
        for (int i = 0; i < wave.count(); ++i) {
            wave [i] = DigFil_lp_40M ((float)wave [i], (float)wave [i], !i);
        }
        break;
    default:
        break;
    }
    return wave;
}

float Fir::DigFil_hp_500k(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -4.806e-04,-4.83e-04,-4.852e-04,-4.871e-04,-4.888e-04,-4.904e-04,-4.919e-04,-4.932e-04,-4.946e-04,-4.96e-04,
        -4.976e-04,-4.992e-04,-5.011e-04,-5.033e-04,-5.059e-04,-5.089e-04,-5.124e-04,-5.165e-04,-5.213e-04,-5.268e-04,
        -5.332e-04,-5.405e-04,-5.488e-04,-5.582e-04,-5.688e-04,-5.807e-04,-5.939e-04,-6.086e-04,-6.249e-04,-6.428e-04,
        -6.624e-04,-6.839e-04,-7.073e-04,-7.327e-04,-7.601e-04,-7.897e-04,-8.216e-04,-8.558e-04,-8.923e-04,-9.314e-04,
        -9.73e-04,-1.017e-03,-1.064e-03,-1.114e-03,-1.166e-03,-1.221e-03,-1.279e-03,-1.34e-03,-1.404e-03,-1.471e-03,
        -1.541e-03,-1.614e-03,-1.69e-03,-1.769e-03,-1.852e-03,-1.937e-03,-2.025e-03,-2.116e-03,-2.211e-03,-2.308e-03,
        -2.408e-03,-2.511e-03,-2.617e-03,-2.726e-03,-2.837e-03,-2.951e-03,-3.068e-03,-3.188e-03,-3.309e-03,-3.433e-03,
        -3.56e-03,-3.688e-03,-3.818e-03,-3.951e-03,-4.085e-03,-4.221e-03,-4.358e-03,-4.497e-03,-4.637e-03,-4.778e-03,
        -4.92e-03,-5.062e-03,-5.206e-03,-5.35e-03,-5.494e-03,-5.638e-03,-5.782e-03,-5.926e-03,-6.07e-03,-6.213e-03,
        -6.355e-03,-6.497e-03,-6.637e-03,-6.776e-03,-6.913e-03,-7.049e-03,-7.183e-03,-7.315e-03,-7.445e-03,-7.572e-03,
        -7.697e-03,-7.819e-03,-7.938e-03,-8.055e-03,-8.168e-03,-8.277e-03,-8.383e-03,-8.485e-03,-8.584e-03,-8.678e-03,
        -8.769e-03,-8.855e-03,-8.936e-03,-9.014e-03,-9.086e-03,-9.154e-03,-9.217e-03,-9.275e-03,-9.328e-03,-9.376e-03,
        -9.419e-03,-9.457e-03,-9.489e-03,-9.516e-03,-9.538e-03,-9.554e-03,-9.565e-03,.4904
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_1M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -2.11e-04,-2.145e-04,-2.179e-04,-2.213e-04,-2.247e-04,-2.279e-04,-2.31e-04,-2.338e-04,-2.364e-04,-2.386e-04,
        -2.402e-04,-2.412e-04,-2.414e-04,-2.407e-04,-2.389e-04,-2.358e-04,-2.313e-04,-2.251e-04,-2.171e-04,-2.071e-04,
        -1.949e-04,-1.803e-04,-1.631e-04,-1.432e-04,-1.203e-04,-9.43e-05,-6.505e-05,-3.242e-05,3.711e-06,4.343e-05,
        8.682e-05,1.339e-04,1.847e-04,2.392e-04,2.974e-04,3.592e-04,4.245e-04,4.93e-04,5.648e-04,6.394e-04,
        7.167e-04,7.963e-04,8.778e-04,9.61e-04,1.045e-03,1.13e-03,1.216e-03,1.301e-03,1.384e-03,1.467e-03,
        1.547e-03,1.624e-03,1.698e-03,1.767e-03,1.831e-03,1.89e-03,1.941e-03,1.985e-03,2.021e-03,2.048e-03,
        2.064e-03,2.07e-03,2.065e-03,2.046e-03,2.015e-03,1.97e-03,1.91e-03,1.835e-03,1.744e-03,1.636e-03,
        1.511e-03,1.369e-03,1.208e-03,1.029e-03,8.306e-04,6.133e-04,3.767e-04,1.206e-04,-1.551e-04,-4.502e-04,
        -7.647e-04,-1.098e-03,-1.451e-03,-1.822e-03,-2.212e-03,-2.619e-03,-3.043e-03,-3.483e-03,-3.939e-03,-4.409e-03,
        -4.893e-03,-5.39e-03,-5.898e-03,-6.417e-03,-6.945e-03,-7.481e-03,-8.023e-03,-8.571e-03,-9.122e-03,-9.675e-03,
        -1.023e-02,-1.078e-02,-1.133e-02,-1.188e-02,-1.242e-02,-1.295e-02,-1.348e-02,-1.399e-02,-1.449e-02,-1.498e-02,
        -1.545e-02,-1.591e-02,-1.635e-02,-1.676e-02,-1.716e-02,-1.754e-02,-1.789e-02,-1.821e-02,-1.851e-02,-1.878e-02,
        -1.903e-02,-1.924e-02,-1.943e-02,-1.959e-02,-1.971e-02,-1.981e-02,-1.987e-02,.4801
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_1M5(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        2.781e-04,2.956e-04,3.128e-04,3.297e-04,3.462e-04,3.624e-04,3.781e-04,3.933e-04,4.079e-04,4.215e-04,
        4.341e-04,4.455e-04,4.553e-04,4.633e-04,4.692e-04,4.726e-04,4.731e-04,4.705e-04,4.644e-04,4.543e-04,
        4.399e-04,4.21e-04,3.971e-04,3.681e-04,3.337e-04,2.937e-04,2.481e-04,1.968e-04,1.398e-04,7.734e-05,
        9.573e-06,-6.315e-05,-1.404e-04,-2.217e-04,-3.063e-04,-3.935e-04,-4.825e-04,-5.723e-04,-6.619e-04,-7.501e-04,
        -8.358e-04,-9.175e-04,-9.941e-04,-1.064e-03,-1.126e-03,-1.178e-03,-1.22e-03,-1.249e-03,-1.264e-03,-1.264e-03,
        -1.249e-03,-1.215e-03,-1.164e-03,-1.093e-03,-1.002e-03,-8.902e-04,-7.581e-04,-6.051e-04,-4.313e-04,-2.372e-04,
        -2.349e-05,2.09e-04,4.591e-04,7.252e-04,1.006e-03,1.298e-03,1.601e-03,1.911e-03,2.226e-03,2.542e-03,
        2.856e-03,3.166e-03,3.466e-03,3.753e-03,4.024e-03,4.274e-03,4.499e-03,4.695e-03,4.859e-03,4.985e-03,
        5.07e-03,5.11e-03,5.102e-03,5.042e-03,4.927e-03,4.754e-03,4.521e-03,4.225e-03,3.864e-03,3.438e-03,
        2.945e-03,2.384e-03,1.756e-03,1.062e-03,3.02e-04,-5.222e-04,-1.408e-03,-2.354e-03,-3.355e-03,-4.41e-03,
        -5.512e-03,-6.659e-03,-7.844e-03,-9.062e-03,-1.031e-02,-1.157e-02,-1.286e-02,-1.415e-02,-1.544e-02,-1.672e-02,
        -1.799e-02,-1.924e-02,-2.047e-02,-2.166e-02,-2.28e-02,-2.39e-02,-2.494e-02,-2.592e-02,-2.683e-02,-2.767e-02,
        -2.843e-02,-2.91e-02,-2.969e-02,-3.018e-02,-3.058e-02,-3.088e-02,-3.109e-02,.4688
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_1M8(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -2.314e-04,-2.383e-04,-2.434e-04,-2.468e-04,-2.483e-04,-2.477e-04,-2.449e-04,-2.398e-04,-2.32e-04,-2.215e-04,
        -2.081e-04,-1.914e-04,-1.715e-04,-1.48e-04,-1.21e-04,-9.039e-05,-5.611e-05,-1.825e-05,2.302e-05,6.748e-05,
        1.148e-04,1.646e-04,2.162e-04,2.692e-04,3.227e-04,3.759e-04,4.28e-04,4.779e-04,5.245e-04,5.667e-04,
        6.034e-04,6.334e-04,6.555e-04,6.685e-04,6.713e-04,6.629e-04,6.424e-04,6.089e-04,5.618e-04,5.005e-04,
        4.249e-04,3.349e-04,2.306e-04,1.125e-04,-1.873e-05,-1.62e-04,-3.161e-04,-4.794e-04,-6.502e-04,-8.261e-04,
        -1.005e-03,-1.184e-03,-1.361e-03,-1.532e-03,-1.694e-03,-1.845e-03,-1.98e-03,-2.097e-03,-2.192e-03,-2.263e-03,
        -2.305e-03,-2.317e-03,-2.296e-03,-2.239e-03,-2.146e-03,-2.014e-03,-1.843e-03,-1.633e-03,-1.383e-03,-1.095e-03,
        -7.706e-04,-4.109e-04,-1.926e-05,4.009e-04,8.456e-04,1.31e-03,1.789e-03,2.276e-03,2.765e-03,3.25e-03,
        3.723e-03,4.176e-03,4.601e-03,4.992e-03,5.338e-03,5.633e-03,5.869e-03,6.037e-03,6.131e-03,6.143e-03,
        6.067e-03,5.898e-03,5.63e-03,5.259e-03,4.783e-03,4.197e-03,3.502e-03,2.697e-03,1.782e-03,7.609e-04,
        -3.646e-04,-1.59e-03,-2.909e-03,-4.316e-03,-5.802e-03,-7.36e-03,-8.979e-03,-1.065e-02,-1.236e-02,-1.41e-02,
        -1.585e-02,-1.76e-02,-1.934e-02,-2.106e-02,-2.274e-02,-2.436e-02,-2.592e-02,-2.741e-02,-2.88e-02,-3.009e-02,
        -3.126e-02,-3.231e-02,-3.323e-02,-3.401e-02,-3.464e-02,-3.512e-02,-3.544e-02,.4644
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_2M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -7.271e-05,-9.578e-05,-1.198e-04,-1.448e-04,-1.705e-04,-1.968e-04,-2.236e-04,-2.507e-04,-2.777e-04,-3.045e-04,
        -3.306e-04,-3.556e-04,-3.791e-04,-4.006e-04,-4.194e-04,-4.351e-04,-4.469e-04,-4.543e-04,-4.566e-04,-4.531e-04,
        -4.433e-04,-4.267e-04,-4.028e-04,-3.712e-04,-3.318e-04,-2.844e-04,-2.292e-04,-1.663e-04,-9.634e-05,-1.983e-05,
        6.235e-05,1.491e-04,2.392e-04,3.311e-04,4.233e-04,5.138e-04,6.007e-04,6.82e-04,7.555e-04,8.19e-04,
        8.704e-04,9.075e-04,9.283e-04,9.31e-04,9.139e-04,8.756e-04,8.151e-04,7.315e-04,6.245e-04,4.943e-04,
        3.414e-04,1.668e-04,-2.792e-05,-2.407e-04,-4.69e-04,-7.097e-04,-9.593e-04,-1.214e-03,-1.469e-03,-1.72e-03,
        -1.962e-03,-2.19e-03,-2.398e-03,-2.581e-03,-2.734e-03,-2.853e-03,-2.931e-03,-2.966e-03,-2.952e-03,-2.887e-03,
        -2.768e-03,-2.593e-03,-2.362e-03,-2.075e-03,-1.731e-03,-1.335e-03,-8.877e-04,-3.945e-04,1.395e-04,7.08e-04,
        1.304e-03,1.918e-03,2.541e-03,3.164e-03,3.776e-03,4.365e-03,4.92e-03,5.428e-03,5.878e-03,6.257e-03,
        6.554e-03,6.758e-03,6.858e-03,6.843e-03,6.706e-03,6.438e-03,6.033e-03,5.486e-03,4.793e-03,3.953e-03,
        2.965e-03,1.832e-03,5.569e-04,-8.546e-04,-2.395e-03,-4.056e-03,-5.825e-03,-7.691e-03,-9.639e-03,-1.165e-02,
        -1.372e-02,-1.582e-02,-1.793e-02,-2.003e-02,-2.211e-02,-2.415e-02,-2.612e-02,-2.8e-02,-2.978e-02,-3.145e-02,
        -3.297e-02,-3.434e-02,-3.554e-02,-3.656e-02,-3.739e-02,-3.802e-02,-3.845e-02,.4613
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_2M5(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.45e-04,-1.322e-04,-1.155e-04,-9.479e-05,-7.034e-05,-4.23e-05,-1.092e-05,2.346e-05,6.045e-05,9.954e-05,
        1.401e-04,1.814e-04,2.226e-04,2.627e-04,3.007e-04,3.353e-04,3.653e-04,3.895e-04,4.066e-04,4.153e-04,
        4.144e-04,4.031e-04,3.803e-04,3.456e-04,2.986e-04,2.394e-04,1.684e-04,8.642e-05,-5.352e-06,-1.052e-04,
        -2.111e-04,-3.205e-04,-4.306e-04,-5.383e-04,-6.4e-04,-7.323e-04,-8.116e-04,-8.743e-04,-9.169e-04,-9.365e-04,
        -9.302e-04,-8.958e-04,-8.319e-04,-7.375e-04,-6.128e-04,-4.585e-04,-2.766e-04,-6.988e-05,1.579e-04,4.021e-04,
        6.57e-04,9.164e-04,1.173e-03,1.42e-03,1.65e-03,1.853e-03,2.024e-03,2.153e-03,2.235e-03,2.264e-03,
        2.234e-03,2.142e-03,1.986e-03,1.764e-03,1.48e-03,1.134e-03,7.327e-04,2.825e-04,-2.08e-04,-7.283e-04,
        -1.266e-03,-1.809e-03,-2.342e-03,-2.851e-03,-3.319e-03,-3.731e-03,-4.072e-03,-4.328e-03,-4.485e-03,-4.533e-03,
        -4.462e-03,-4.266e-03,-3.939e-03,-3.482e-03,-2.898e-03,-2.19e-03,-1.37e-03,-4.506e-04,5.524e-04,1.619e-03,
        2.726e-03,3.849e-03,4.959e-03,6.027e-03,7.022e-03,7.914e-03,8.67e-03,9.26e-03,9.656e-03,9.83e-03,
        9.758e-03,9.419e-03,8.798e-03,7.881e-03,6.663e-03,5.14e-03,3.317e-03,1.203e-03,-1.186e-03,-3.83e-03,
        -6.702e-03,-9.77e-03,-1.3e-02,-1.635e-02,-1.978e-02,-2.324e-02,-2.668e-02,-3.006e-02,-3.332e-02,-3.641e-02,
        -3.93e-02,-4.194e-02,-4.428e-02,-4.629e-02,-4.793e-02,-4.919e-02,-5.004e-02,.4495
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_3M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        2.288e-04,2.447e-04,2.546e-04,2.581e-04,2.547e-04,2.444e-04,2.268e-04,2.022e-04,1.707e-04,1.326e-04,
        8.881e-05,4.007e-05,-1.241e-05,-6.72e-05,-1.226e-04,-1.767e-04,-2.274e-04,-2.724e-04,-3.095e-04,-3.363e-04,
        -3.508e-04,-3.511e-04,-3.356e-04,-3.033e-04,-2.535e-04,-1.866e-04,-1.033e-04,-5.309e-06,1.05e-04,2.244e-04,
        3.49e-04,4.742e-04,5.951e-04,7.062e-04,8.022e-04,8.776e-04,9.273e-04,9.469e-04,9.327e-04,8.821e-04,
        7.938e-04,6.677e-04,5.056e-04,3.107e-04,8.791e-05,-1.564e-04,-4.143e-04,-6.766e-04,-9.334e-04,-1.174e-03,
        -1.387e-03,-1.562e-03,-1.69e-03,-1.76e-03,-1.766e-03,-1.702e-03,-1.565e-03,-1.355e-03,-1.074e-03,-7.272e-04,
        -3.235e-04,1.26e-04,6.073e-04,1.104e-03,1.598e-03,2.071e-03,2.502e-03,2.871e-03,3.16e-03,3.352e-03,
        3.431e-03,3.388e-03,3.214e-03,2.907e-03,2.469e-03,1.906e-03,1.231e-03,4.618e-04,-3.797e-04,-1.267e-03,
        -2.169e-03,-3.054e-03,-3.886e-03,-4.632e-03,-5.255e-03,-5.724e-03,-6.009e-03,-6.087e-03,-5.938e-03,-5.551e-03,
        -4.922e-03,-4.055e-03,-2.965e-03,-1.672e-03,-2.092e-04,1.384e-03,3.06e-03,4.765e-03,6.439e-03,8.018e-03,
        9.438e-03,1.063e-02,1.154e-02,1.209e-02,1.224e-02,1.194e-02,1.116e-02,9.856e-03,8.03e-03,5.677e-03,
        2.811e-03,-5.426e-04,-4.341e-03,-8.53e-03,-1.304e-02,-1.78e-02,-2.273e-02,-2.771e-02,-3.267e-02,-3.75e-02,
        -4.21e-02,-4.637e-02,-5.022e-02,-5.357e-02,-5.634e-02,-5.848e-02,-5.993e-02,.4393
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_5M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.842e-04,-2.222e-04,-2.44e-04,-2.474e-04,-2.312e-04,-1.962e-04,-1.446e-04,-8.018e-05,-8.163e-06,6.516e-05,
        1.329e-04,1.88e-04,2.24e-04,2.356e-04,2.195e-04,1.747e-04,1.028e-04,8.55e-06,-1.007e-04,-2.151e-04,
        -3.233e-04,-4.135e-04,-4.743e-04,-4.961e-04,-4.726e-04,-4.016e-04,-2.855e-04,-1.319e-04,4.678e-05,2.342e-04,
        4.113e-04,5.584e-04,6.566e-04,6.908e-04,6.508e-04,5.337e-04,3.443e-04,9.559e-05,-1.916e-04,-4.907e-04,
        -7.71e-04,-1.001e-03,-1.153e-03,-1.202e-03,-1.134e-03,-9.472e-04,-6.491e-04,-2.619e-04,1.816e-04,6.397e-04,
        1.066e-03,1.412e-03,1.636e-03,1.704e-03,1.596e-03,1.309e-03,8.588e-04,2.788e-04,-3.809e-04,-1.058e-03,
        -1.683e-03,-2.188e-03,-2.51e-03,-2.603e-03,-2.439e-03,-2.016e-03,-1.357e-03,-5.136e-04,4.413e-04,1.417e-03,
        2.315e-03,3.037e-03,3.496e-03,3.624e-03,3.384e-03,2.774e-03,1.831e-03,6.247e-04,-7.384e-04,-2.13e-03,
        -3.411e-03,-4.44e-03,-5.094e-03,-5.278e-03,-4.939e-03,-4.072e-03,-2.726e-03,-1.003e-03,9.497e-04,2.951e-03,
        4.799e-03,6.295e-03,7.258e-03,7.547e-03,7.078e-03,5.839e-03,3.889e-03,1.368e-03,-1.518e-03,-4.507e-03,
        -7.306e-03,-9.614e-03,-1.115e-02,-1.169e-02,-1.107e-02,-9.243e-03,-6.264e-03,-2.306e-03,2.346e-03,7.307e-03,
        1.212e-02,1.629e-02,1.932e-02,2.075e-02,2.018e-02,1.735e-02,1.214e-02,4.567e-03,-5.156e-03,-1.667e-02,
        -2.945e-02,-4.288e-02,-5.626e-02,-6.884e-02,-7.993e-02,-8.888e-02,-9.515e-02,.4016
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_8M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.871e-04,-1.352e-04,-4.79e-05,5.466e-05,1.482e-04,2.094e-04,2.219e-04,1.798e-04,9.02e-05,-2.78e-05,
        -1.467e-04,-2.365e-04,-2.722e-04,-2.399e-04,-1.419e-04,2.954e-06,1.616e-04,2.945e-04,3.645e-04,3.47e-04,
        2.376e-04,5.552e-05,-1.593e-04,-3.539e-04,-4.751e-04,-4.834e-04,-3.649e-04,-1.374e-04,1.504e-04,4.292e-04,
        6.246e-04,6.768e-04,5.574e-04,2.808e-04,-9.62e-05,-4.843e-04,-7.827e-04,-9.044e-04,-8.004e-04,-4.766e-04,
        2.954e-06,5.271e-04,9.628e-04,1.188e-03,1.124e-03,7.632e-04,1.72e-04,-5.149e-04,-1.127e-03,-1.498e-03,
        -1.51e-03,-1.131e-03,-4.259e-04,4.491e-04,1.28e-03,1.848e-03,1.984e-03,1.618e-03,8.045e-04,-2.805e-04,
        -1.377e-03,-2.203e-03,-2.522e-03,-2.213e-03,-1.309e-03,2.954e-06,1.414e-03,2.567e-03,3.145e-03,2.956e-03,
        1.991e-03,4.423e-04,-1.334e-03,-2.897e-03,-3.828e-03,-3.84e-03,-2.863e-03,-1.076e-03,1.12e-03,3.19e-03,
        4.591e-03,4.913e-03,3.995e-03,1.98e-03,-6.947e-04,-3.389e-03,-5.413e-03,-6.193e-03,-5.436e-03,-3.218e-03,
        2.954e-06,3.477e-03,6.329e-03,7.777e-03,7.334e-03,4.959e-03,1.103e-03,-3.366e-03,-7.35e-03,-9.782e-03,
        -9.894e-03,-7.447e-03,-2.831e-03,2.974e-03,8.587e-03,1.254e-02,1.364e-02,1.129e-02,5.704e-03,-2.054e-03,
        -1.025e-02,-1.681e-02,-1.983e-02,-1.801e-02,-1.108e-02,2.954e-06,1.31e-02,2.523e-02,3.305e-02,3.357e-02,
        2.477e-02,6.109e-03,-2.123e-02,-5.439e-02,-8.925e-02,-.1211,-.1453,.3415
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_10M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        2.09e-04,1.723e-04,7.205e-05,-5.559e-05,-1.631e-04,-2.087e-04,-1.719e-04,-6.228e-05,8.212e-05,2.076e-04,
        2.637e-04,2.232e-04,9.409e-05,-8.028e-05,-2.348e-04,-3.062e-04,-2.581e-04,-9.811e-05,1.209e-04,3.168e-04,
        4.087e-04,3.486e-04,1.452e-04,-1.346e-04,-3.856e-04,-5.035e-04,-4.267e-04,-1.66e-04,1.923e-04,5.133e-04,
        6.635e-04,5.646e-04,2.315e-04,-2.248e-04,-6.323e-04,-8.216e-04,-6.949e-04,-2.726e-04,3.033e-04,8.154e-04,
        1.051e-03,8.904e-04,3.606e-04,-3.587e-04,-9.956e-04,-1.287e-03,-1.084e-03,-4.267e-04,4.626e-04,1.247e-03,
        1.603e-03,1.351e-03,5.425e-04,-5.465e-04,-1.503e-03,-1.935e-03,-1.626e-03,-6.4e-04,6.827e-04,1.841e-03,
        2.361e-03,1.984e-03,7.918e-04,-8.037e-04,-2.198e-03,-2.82e-03,-2.365e-03,-9.313e-04,9.833e-04,2.653e-03,
        3.397e-03,2.849e-03,1.133e-03,-1.156e-03,-3.151e-03,-4.038e-03,-3.383e-03,-1.334e-03,1.4e-03,3.781e-03,
        4.841e-03,4.059e-03,1.612e-03,-1.653e-03,-4.502e-03,-5.772e-03,-4.841e-03,-1.913e-03,2.003e-03,5.427e-03,
        6.962e-03,5.852e-03,2.328e-03,-2.402e-03,-6.556e-03,-8.437e-03,-7.106e-03,-2.823e-03,2.963e-03,8.08e-03,
        1.043e-02,8.828e-03,3.536e-03,-3.688e-03,-1.015e-02,-1.32e-02,-1.124e-02,-4.525e-03,4.802e-03,1.331e-02,
        1.747e-02,1.507e-02,6.159e-03,-6.594e-03,-1.863e-02,-2.496e-02,-2.203e-02,-9.238e-03,1.026e-02,3.007e-02,
        4.222e-02,3.949e-02,1.786e-02,-2.184e-02,-7.362e-02,-.1275,-.172,.3028
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_12M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -2.042e-04,-1.968e-04,-8.999e-05,6.106e-05,1.759e-04,1.904e-04,9.176e-05,-7.189e-05,-2.142e-04,-2.549e-04,
        -1.64e-04,1.792e-05,1.963e-04,2.706e-04,1.896e-04,-1.509e-05,-2.394e-04,-3.58e-04,-2.928e-04,-6.25e-05,
        2.184e-04,3.948e-04,3.551e-04,9.95e-05,-2.484e-04,-4.99e-04,-4.989e-04,-2.219e-04,2.021e-04,5.455e-04,
        6.034e-04,3.137e-04,-1.932e-04,-6.491e-04,-7.883e-04,-4.999e-04,9.32e-05,6.819e-04,9.298e-04,6.629e-04,
        -1.509e-05,-7.562e-04,-1.144e-03,-9.253e-04,-1.697e-04,7.413e-04,1.304e-03,1.167e-03,3.477e-04,-7.474e-04,
        -1.521e-03,-1.507e-03,-6.467e-04,6.42e-04,1.665e-03,1.821e-03,9.517e-04,-5.337e-04,-1.844e-03,-2.225e-03,
        -1.388e-03,2.889e-04,1.924e-03,2.592e-03,1.84e-03,-1.509e-05,-2.01e-03,-3.031e-03,-2.429e-03,-4.221e-04,
        1.963e-03,3.411e-03,3.037e-03,9.163e-04,-1.884e-03,-3.839e-03,-3.784e-03,-1.604e-03,1.631e-03,4.176e-03,
        4.55e-03,2.381e-03,-1.297e-03,-4.526e-03,-5.456e-03,-3.391e-03,7.313e-04,4.745e-03,6.382e-03,4.539e-03,
        -1.509e-05,-4.926e-03,-7.455e-03,-5.987e-03,-1.025e-03,4.916e-03,8.567e-03,7.672e-03,2.346e-03,-4.79e-03,
        -9.863e-03,-9.813e-03,-4.189e-03,4.36e-03,1.127e-02,1.246e-02,6.639e-03,-3.639e-03,-1.302e-02,-1.605e-02,
        -1.021e-02,2.302e-03,1.522e-02,2.117e-02,1.565e-02,-1.509e-05,-1.854e-02,-2.968e-02,-2.54e-02,-4.642e-03,
        2.463e-02,4.76e-02,4.844e-02,1.745e-02,-4.357e-02,-.1205,-.1912,.2666
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_15M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.351e-04,3.798e-05,1.887e-04,1.918e-04,3.959e-05,-1.473e-04,-2.14e-04,-9.793e-05,1.141e-04,2.489e-04,
        1.865e-04,-3.507e-05,-2.395e-04,-2.502e-04,-4.069e-05,2.29e-04,3.32e-04,1.633e-04,-1.582e-04,-3.695e-04,
        -2.762e-04,7.205e-05,3.994e-04,4.194e-04,8.258e-05,-3.556e-04,-5.249e-04,-2.502e-04,2.758e-04,6.219e-04,
        4.69e-04,-1.01e-04,-6.354e-04,-6.667e-04,-1.175e-04,5.931e-04,8.648e-04,4.195e-04,-4.26e-04,-9.777e-04,
        -7.304e-04,1.767e-04,1.02e-03,1.065e-03,2.005e-04,-9.091e-04,-1.327e-03,-6.329e-04,6.727e-04,1.517e-03,
        1.133e-03,-2.53e-04,-1.531e-03,-1.594e-03,-2.858e-04,1.38e-03,2.e-03,9.588e-04,-9.831e-04,-2.229e-03,
        -1.656e-03,3.881e-04,2.263e-03,2.348e-03,4.328e-04,-1.993e-03,-2.889e-03,-1.374e-03,1.437e-03,3.233e-03,
        2.401e-03,-5.425e-04,-3.233e-03,-3.35e-03,-6.043e-04,2.866e-03,4.145e-03,1.977e-03,-2.036e-03,-4.596e-03,
        -3.408e-03,7.891e-04,4.627e-03,4.795e-03,8.78e-04,-4.079e-03,-5.911e-03,-2.815e-03,2.934e-03,6.617e-03,
        4.92e-03,-1.123e-03,-6.676e-03,-6.94e-03,-1.262e-03,5.974e-03,8.687e-03,4.165e-03,-4.33e-03,-9.841e-03,
        -7.359e-03,1.711e-03,1.017e-02,1.066e-02,1.97e-03,-9.324e-03,-1.372e-02,-6.649e-03,7.043e-03,1.623e-02,
        1.235e-02,-2.903e-03,-1.772e-02,-1.902e-02,-3.595e-03,1.765e-02,2.689e-02,1.358e-02,-1.504e-02,-3.667e-02,
        -2.982e-02,7.635e-03,5.144e-02,6.296e-02,1.423e-02,-9.01e-02,-.2099,.2105
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_18M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        7.839e-05,2.174e-04,1.264e-04,-9.543e-05,-1.948e-04,-5.095e-05,1.795e-04,2.306e-04,3.133e-05,-1.994e-04,
        -1.903e-04,6.617e-05,2.844e-04,2.004e-04,-1.121e-04,-2.993e-04,-1.244e-04,2.373e-04,3.685e-04,8.79e-05,
        -3.078e-04,-3.525e-04,4.417e-05,4.486e-04,3.725e-04,-1.422e-04,-5.187e-04,-2.872e-04,3.353e-04,6.364e-04,
        2.191e-04,-4.855e-04,-6.552e-04,-3.117e-05,7.122e-04,6.896e-04,-1.469e-04,-8.675e-04,-5.924e-04,4.418e-04,
        1.061e-03,4.814e-04,-7.109e-04,-1.138e-03,-2.167e-04,1.067e-03,1.203e-03,-7.227e-05,-1.352e-03,-1.101e-03,
        5.099e-04,1.666e-03,9.438e-04,-9.485e-04,-1.842e-03,-5.854e-04,1.492e-03,1.972e-03,1.536e-04,-1.973e-03,
        -1.89e-03,4.749e-04,2.476e-03,1.696e-03,-1.147e-03,-2.819e-03,-1.235e-03,1.96e-03,3.077e-03,6.302e-04,
        -2.73e-03,-3.067e-03,2.453e-04,3.529e-03,2.87e-03,-1.237e-03,-4.152e-03,-2.316e-03,2.433e-03,4.653e-03,
        1.513e-03,-3.641e-03,-4.818e-03,-3.22e-04,4.913e-03,4.703e-03,-1.109e-03,-6.02e-03,-4.105e-03,2.874e-03,
        6.984e-03,3.098e-03,-4.777e-03,-7.556e-03,-1.507e-03,6.863e-03,7.74e-03,-5.603e-04,-8.89e-03,-7.272e-03,
        3.244e-03,1.085e-02,6.145e-03,-6.408e-03,-1.247e-02,-4.073e-03,1.017e-02,1.369e-02,9.924e-04,-1.442e-02,
        -1.414e-02,3.511e-03,1.934e-02,1.366e-02,-9.814e-03,-2.501e-02,-1.16e-02,1.913e-02,3.221e-02,6.994e-03,
        -3.42e-02,-4.284e-02,3.651e-03,6.59e-02,6.65e-02,-3.947e-02,-.2114,.1574
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_20M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.217e-05,-2.033e-04,-1.319e-04,1.095e-04,1.887e-04,-1.217e-05,-2.233e-04,-1.465e-04,1.266e-04,2.202e-04,
        -1.217e-05,-2.628e-04,-1.735e-04,1.562e-04,2.725e-04,-1.217e-05,-3.241e-04,-2.143e-04,1.998e-04,3.479e-04,
        -1.217e-05,-4.094e-04,-2.701e-04,2.589e-04,4.487e-04,-1.217e-05,-5.211e-04,-3.426e-04,3.349e-04,5.775e-04,
        -1.217e-05,-6.618e-04,-4.334e-04,4.295e-04,7.371e-04,-1.217e-05,-8.345e-04,-5.443e-04,5.448e-04,9.306e-04,
        -1.217e-05,-1.043e-03,-6.776e-04,6.827e-04,1.162e-03,-1.217e-05,-1.29e-03,-8.356e-04,8.461e-04,1.435e-03,
        -1.217e-05,-1.581e-03,-1.021e-03,1.038e-03,1.755e-03,-1.217e-05,-1.922e-03,-1.239e-03,1.262e-03,2.13e-03,
        -1.217e-05,-2.321e-03,-1.493e-03,1.524e-03,2.567e-03,-1.217e-05,-2.786e-03,-1.79e-03,1.831e-03,3.079e-03,
        -1.217e-05,-3.332e-03,-2.138e-03,2.191e-03,3.681e-03,-1.217e-05,-3.977e-03,-2.551e-03,2.618e-03,4.397e-03,
        -1.217e-05,-4.746e-03,-3.044e-03,3.131e-03,5.26e-03,-1.217e-05,-5.681e-03,-3.646e-03,3.758e-03,6.32e-03,
        -1.217e-05,-6.841e-03,-4.398e-03,4.547e-03,7.661e-03,-1.217e-05,-8.328e-03,-5.368e-03,5.574e-03,9.421e-03,
        -1.217e-05,-1.032e-02,-6.682e-03,6.98e-03,1.186e-02,-1.217e-05,-1.316e-02,-8.585e-03,9.052e-03,1.553e-02,
        -1.217e-05,-1.761e-02,-1.164e-02,1.247e-02,2.177e-02,-1.217e-05,-2.577e-02,-1.75e-02,1.937e-02,3.512e-02,
        -1.217e-05,-4.615e-02,-3.377e-02,4.131e-02,8.604e-02,-1.217e-05,-.2011,.1271
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_22M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -5.413e-05,1.848e-04,1.382e-04,-1.25e-04,-1.784e-04,7.49e-05,2.292e-04,2.215e-05,-2.221e-04,-9.688e-05,
        2.139e-04,2.009e-04,-1.402e-04,-2.601e-04,6.412e-05,3.226e-04,6.952e-05,-3.137e-04,-1.866e-04,2.852e-04,
        3.312e-04,-1.711e-04,-4.197e-04,3.684e-05,4.912e-04,1.66e-04,-4.638e-04,-3.526e-04,3.862e-04,5.541e-04,
        -1.945e-04,-6.737e-04,-3.752e-05,7.397e-04,3.45e-04,-6.638e-04,-6.261e-04,4.955e-04,8.936e-04,-1.79e-04,
        -1.035e-03,-1.964e-04,1.066e-03,6.447e-04,-8.97e-04,-1.04e-03,5.829e-04,1.372e-03,-8.447e-05,-1.51e-03,
        -4.846e-04,1.461e-03,1.108e-03,-1.137e-03,-1.63e-03,6.081e-04,2.011e-03,1.395e-04,-2.104e-03,-9.564e-04,
        1.91e-03,1.787e-03,-1.35e-03,-2.436e-03,5.187e-04,2.836e-03,5.573e-04,-2.82e-03,-1.682e-03,2.39e-03,
        2.748e-03,-1.487e-03,-3.515e-03,2.444e-04,3.882e-03,1.258e-03,-3.665e-03,-2.76e-03,2.876e-03,4.093e-03,
        -1.485e-03,-4.958e-03,-3.18e-04,5.216e-03,2.381e-03,-4.668e-03,-4.361e-03,3.339e-03,6.005e-03,-1.247e-03,
        -6.944e-03,-1.345e-03,6.983e-03,4.187e-03,-5.906e-03,-6.823e-03,3.751e-03,8.882e-03,-5.923e-04,-9.888e-03,
        -3.212e-03,9.558e-03,7.281e-03,-7.617e-03,-1.1e-02,4.087e-03,1.38e-02,9.286e-04,-1.501e-02,-6.989e-03,
        1.413e-02,1.357e-02,-1.065e-02,-1.985e-02,4.324e-03,2.497e-02,5.11e-03,-2.781e-02,-1.776e-02,2.709e-02,
        3.415e-02,-2.076e-02,-5.593e-02,4.446e-03,9.027e-02,3.94e-02,-.1863,9.335e-02
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_25M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.545e-04,1.559e-04,-1.322e-04,-1.346e-04,1.632e-04,1.668e-04,-1.452e-04,-1.499e-04,1.809e-04,1.868e-04,
        -1.677e-04,-1.748e-04,2.083e-04,2.168e-04,-2.003e-04,-2.102e-04,2.464e-04,2.576e-04,-2.44e-04,-2.568e-04,
        2.959e-04,3.102e-04,-2.996e-04,-3.155e-04,3.579e-04,3.754e-04,-3.682e-04,-3.875e-04,4.332e-04,4.543e-04,
        -4.506e-04,-4.736e-04,5.231e-04,5.479e-04,-5.481e-04,-5.75e-04,6.285e-04,6.575e-04,-6.619e-04,-6.93e-04,
        7.509e-04,7.843e-04,-7.932e-04,-8.29e-04,8.916e-04,9.299e-04,-9.438e-04,-9.847e-04,1.052e-03,1.096e-03,
        -1.115e-03,-1.162e-03,1.235e-03,1.285e-03,-1.31e-03,-1.363e-03,1.443e-03,1.499e-03,-1.531e-03,-1.591e-03,
        1.678e-03,1.741e-03,-1.781e-03,-1.848e-03,1.944e-03,2.016e-03,-2.064e-03,-2.141e-03,2.245e-03,2.327e-03,
        -2.386e-03,-2.473e-03,2.588e-03,2.682e-03,-2.752e-03,-2.852e-03,2.981e-03,3.088e-03,-3.173e-03,-3.288e-03,
        3.433e-03,3.557e-03,-3.66e-03,-3.795e-03,3.96e-03,4.105e-03,-4.231e-03,-4.389e-03,4.581e-03,4.754e-03,
        -4.909e-03,-5.1e-03,5.325e-03,5.536e-03,-5.732e-03,-5.966e-03,6.239e-03,6.501e-03,-6.754e-03,-7.05e-03,
        7.392e-03,7.73e-03,-8.067e-03,-8.457e-03,8.904e-03,9.36e-03,-9.831e-03,-1.037e-02,1.099e-02,1.165e-02,
        -1.235e-02,-1.316e-02,1.41e-02,1.514e-02,-1.63e-02,-1.767e-02,1.929e-02,2.12e-02,-2.347e-02,-2.629e-02,
        2.989e-02,3.456e-02,-4.088e-02,-5.004e-02,6.444e-02,9.028e-02,-.1505,4.826e-02
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_28M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.966e-04,-9.099e-05,-1.514e-04,1.667e-04,1.086e-04,-2.003e-04,-2.163e-05,2.356e-04,-5.267e-05,-2.159e-04,
        1.561e-04,1.877e-04,-2.267e-04,-9.967e-05,3.019e-04,6.33e-06,-3.175e-04,1.336e-04,3.124e-04,-2.542e-04,
        -2.286e-04,3.862e-04,1.16e-04,-4.563e-04,6.738e-05,4.932e-04,-2.528e-04,-4.291e-04,4.636e-04,3.066e-04,
        -6.159e-04,-7.972e-05,7.252e-04,-1.815e-04,-7.102e-04,4.941e-04,6.013e-04,-7.62e-04,-3.443e-04,9.85e-04,
        6.33e-06,-1.063e-03,4.252e-04,1.01e-03,-8.429e-04,-7.546e-04,1.228e-03,3.565e-04,-1.458e-03,1.98e-04,
        1.521e-03,-7.926e-04,-1.324e-03,1.39e-03,9.062e-04,-1.841e-03,-2.467e-04,2.1e-03,-5.357e-04,-2.042e-03,
        1.388e-03,1.677e-03,-2.132e-03,-9.609e-04,2.684e-03,6.33e-06,-2.874e-03,1.125e-03,2.667e-03,-2.23e-03,
        -1.984e-03,3.181e-03,9.106e-04,-3.754e-03,4.956e-04,3.853e-03,-2.012e-03,-3.339e-03,3.472e-03,2.251e-03,
        -4.586e-03,-6.208e-04,5.182e-03,-1.33e-03,-5.035e-03,3.402e-03,4.107e-03,-5.241e-03,-2.367e-03,6.58e-03,
        6.33e-06,-7.083e-03,2.767e-03,6.589e-03,-5.545e-03,-4.954e-03,7.959e-03,2.284e-03,-9.527e-03,1.256e-03,
        9.913e-03,-5.242e-03,-8.782e-03,9.219e-03,6.053e-03,-1.254e-02,-1.735e-03,1.464e-02,-3.848e-03,-1.486e-02,
        1.027e-02,1.274e-02,-1.679e-02,-7.854e-03,2.262e-02,6.33e-06,-2.673e-02,1.101e-02,2.799e-02,-2.541e-02,
        -2.479e-02,4.413e-02,1.436e-02,-7.051e-02,1.14e-02,.1212,-.1024,8.637e-03
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_30M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -2.08e-04,5.34e-05,1.561e-04,-1.764e-04,-7.409e-05,2.076e-04,-7.742e-05,-1.939e-04,1.824e-04,6.681e-05,
        -2.625e-04,7.276e-05,2.136e-04,-2.407e-04,-1.013e-04,3.047e-04,-1.102e-04,-2.872e-04,2.833e-04,1.083e-04,
        -4.067e-04,1.204e-04,3.466e-04,-3.822e-04,-1.587e-04,5.01e-04,-1.743e-04,-4.64e-04,4.694e-04,1.83e-04,
        -6.603e-04,2.025e-04,5.715e-04,-6.173e-04,-2.524e-04,8.175e-04,-2.762e-04,-7.419e-04,7.585e-04,2.978e-04,
        -1.046e-03,3.264e-04,9.079e-04,-9.661e-04,-3.905e-04,1.28e-03,-4.243e-04,-1.143e-03,1.174e-03,4.618e-04,
        -1.595e-03,5.015e-04,1.382e-03,-1.455e-03,-5.835e-04,1.925e-03,-6.3e-04,-1.699e-03,1.747e-03,6.878e-04,
        -2.349e-03,7.42e-04,2.031e-03,-2.126e-03,-8.475e-04,2.807e-03,-9.11e-04,-2.458e-03,2.53e-03,9.965e-04,
        -3.38e-03,1.071e-03,2.92e-03,-3.044e-03,-1.21e-03,4.019e-03,-1.298e-03,-3.506e-03,3.615e-03,1.425e-03,
        -4.817e-03,1.531e-03,4.169e-03,-4.339e-03,-1.723e-03,5.744e-03,-1.852e-03,-5.015e-03,5.186e-03,2.051e-03,
        -6.928e-03,2.212e-03,6.033e-03,-6.29e-03,-2.504e-03,8.396e-03,-2.713e-03,-7.388e-03,7.687e-03,3.059e-03,
        -1.038e-02,3.344e-03,9.18e-03,-9.641e-03,-3.871e-03,1.313e-02,-4.285e-03,-1.182e-02,1.248e-02,5.046e-03,
        -1.739e-02,5.715e-03,1.601e-02,-1.721e-02,-7.094e-03,2.484e-02,-8.384e-03,-2.41e-02,2.669e-02,1.142e-02,
        -4.201e-02,1.5e-02,4.65e-02,-5.693e-02,-2.8e-02,.1269,-6.54e-02,-1.377e-02
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_32M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        2.009e-04,-1.494e-05,-1.626e-04,1.863e-04,3.705e-05,-1.965e-04,1.633e-04,9.508e-05,-2.266e-04,1.289e-04,
        1.603e-04,-2.501e-04,7.912e-05,2.325e-04,-2.621e-04,1.041e-05,3.091e-04,-2.562e-04,-7.986e-05,3.847e-04,
        -2.248e-04,-1.921e-04,4.511e-04,-1.604e-04,-3.234e-04,4.978e-04,-5.708e-05,-4.672e-04,5.121e-04,8.861e-05,
        -6.125e-04,4.81e-04,2.759e-04,-7.443e-04,3.923e-04,4.987e-04,-8.443e-04,2.37e-04,7.451e-04,-8.921e-04,
        1.041e-05,9.969e-04,-8.673e-04,-2.855e-04,1.23e-03,-7.514e-04,-6.409e-04,1.417e-03,-5.305e-04,-1.038e-03,
        1.527e-03,-1.977e-04,-1.449e-03,1.528e-03,2.448e-04,-1.839e-03,1.394e-03,7.836e-04,-2.167e-03,1.102e-03,
        1.393e-03,-2.389e-03,6.409e-04,2.037e-03,-2.459e-03,1.041e-05,2.666e-03,-2.335e-03,-7.742e-04,3.223e-03,
        -1.982e-03,-1.682e-03,3.643e-03,-1.378e-03,-2.665e-03,3.861e-03,-5.153e-04,-3.659e-03,3.812e-03,5.951e-04,
        -4.587e-03,3.439e-03,1.921e-03,-5.36e-03,2.698e-03,3.41e-03,-5.881e-03,1.558e-03,4.984e-03,-6.052e-03,
        1.041e-05,6.548e-03,-5.775e-03,-1.931e-03,7.985e-03,-4.956e-03,-4.229e-03,9.162e-03,-3.51e-03,-6.822e-03,
        9.928e-03,-1.356e-03,-9.631e-03,1.012e-02,1.585e-03,-1.255e-02,9.533e-03,5.413e-03,-1.548e-02,7.933e-03,
        1.028e-02,-1.828e-02,4.962e-03,1.648e-02,-2.085e-02,1.041e-05,2.467e-02,-2.306e-02,-8.241e-03,3.653e-02,
        -2.481e-02,-2.351e-02,5.769e-02,-2.603e-02,-6.232e-02,.1213,-2.665e-02,-3.904e-02
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_hp_35M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.446e-04,-1.961e-04,9.606e-05,9.762e-05,-2.063e-04,1.567e-04,3.809e-05,-2.013e-04,2.144e-04,-3.516e-05,
        -1.768e-04,2.647e-04,-1.22e-04,-1.274e-04,3.001e-04,-2.192e-04,-4.831e-05,3.109e-04,-3.195e-04,6.27e-05,
        2.856e-04,-4.111e-04,2.033e-04,2.135e-04,-4.775e-04,3.649e-04,8.729e-05,-4.998e-04,5.316e-04,-9.419e-05,
        -4.59e-04,6.808e-04,-3.235e-04,-3.394e-04,7.847e-04,-5.83e-04,-1.326e-04,8.134e-04,-8.447e-04,1.589e-04,
        7.393e-04,-1.071e-03,5.193e-04,5.423e-04,-1.221e-03,9.179e-04,2.143e-04,-1.25e-03,1.31e-03,-2.358e-04,
        -1.122e-03,1.64e-03,-7.797e-04,-8.113e-04,1.846e-03,-1.369e-03,-3.123e-04,1.871e-03,-1.937e-03,3.57e-04,
        1.664e-03,-2.405e-03,1.152e-03,1.195e-03,-2.687e-03,2.001e-03,4.615e-04,-2.703e-03,2.809e-03,-5.074e-04,
        -2.389e-03,3.466e-03,-1.646e-03,-1.706e-03,3.855e-03,-2.854e-03,-6.517e-04,3.868e-03,-4.001e-03,7.316e-04,
        3.415e-03,-4.934e-03,2.355e-03,2.441e-03,-5.495e-03,4.085e-03,9.396e-04,-5.529e-03,5.744e-03,-1.043e-03,
        -4.906e-03,7.126e-03,-3.399e-03,-3.533e-03,8.006e-03,-5.959e-03,-1.37e-03,8.157e-03,-8.5e-03,1.562e-03,
        7.362e-03,-1.075e-02,5.177e-03,5.427e-03,-1.238e-02,9.325e-03,2.175e-03,-1.305e-02,1.38e-02,-2.564e-03,
        -1.233e-02,1.836e-02,-9.019e-03,-9.682e-03,2.272e-02,-1.763e-02,-4.251e-03,2.662e-02,-2.95e-02,5.807e-03,
        2.98e-02,-4.812e-02,2.619e-02,3.205e-02,-8.975e-02,9.003e-02,3.322e-02,-6.771e-02
    };
    if (setic==1){
        states[0] = (invar - 2.*initval);
        for (i=0;i<127;i++) states[i] = states[0];
        for (i=127;i<255;i++) states[i] = invar;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_100Hz(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[15] = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};
    static float znum[8] = {
        -3.471e-03,-4.851e-03,-4.246e-03,8.891e-03,4.424e-02,.1002,.1601,.1991
    };
    if (setic==1){
        for (i=0;i<15;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<15;i++){
            sumnum += states[i]*znum[i<8?i:15-i];
            if (i<14) states[i] = states[i+1];
        }
        states[14] = invar;
        sumnum += states[14]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_2M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -6.158e-05,-3.77e-05,-1.28e-05,1.301e-05,3.962e-05,6.688e-05,9.462e-05,1.226e-04,1.506e-04,1.783e-04,
        2.053e-04,2.312e-04,2.556e-04,2.778e-04,2.973e-04,3.135e-04,3.258e-04,3.334e-04,3.357e-04,3.322e-04,
        3.22e-04,3.048e-04,2.8e-04,2.474e-04,2.066e-04,1.575e-04,1.004e-04,3.534e-05,-3.712e-05,-1.163e-04,
        -2.014e-04,-2.912e-04,-3.844e-04,-4.796e-04,-5.749e-04,-6.686e-04,-7.586e-04,-8.427e-04,-9.188e-04,-9.845e-04,
        -1.038e-03,-1.076e-03,-1.098e-03,-1.1e-03,-1.083e-03,-1.043e-03,-9.805e-04,-8.94e-04,-7.833e-04,-6.485e-04,
        -4.902e-04,-3.095e-04,-1.079e-04,1.123e-04,3.486e-04,5.978e-04,8.561e-04,1.12e-03,1.384e-03,1.643e-03,
        1.894e-03,2.13e-03,2.345e-03,2.535e-03,2.693e-03,2.816e-03,2.897e-03,2.933e-03,2.918e-03,2.851e-03,
        2.728e-03,2.548e-03,2.308e-03,2.011e-03,1.655e-03,1.245e-03,7.82e-04,2.715e-04,-2.813e-04,-8.697e-04,
        -1.486e-03,-2.122e-03,-2.767e-03,-3.412e-03,-4.045e-03,-4.655e-03,-5.229e-03,-5.755e-03,-6.221e-03,-6.613e-03,
        -6.921e-03,-7.132e-03,-7.235e-03,-7.22e-03,-7.078e-03,-6.801e-03,-6.381e-03,-5.815e-03,-5.098e-03,-4.228e-03,
        -3.206e-03,-2.033e-03,-7.133e-04,7.478e-04,2.342e-03,4.061e-03,5.893e-03,7.824e-03,9.841e-03,1.193e-02,
        1.406e-02,1.623e-02,1.842e-02,2.06e-02,2.275e-02,2.486e-02,2.69e-02,2.885e-02,3.069e-02,3.241e-02,
        3.399e-02,3.541e-02,3.665e-02,3.771e-02,3.857e-02,3.922e-02,3.966e-02,3.988e-02
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_5M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.411e-04,1.795e-04,2.016e-04,2.05e-04,1.887e-04,1.532e-04,1.01e-04,3.584e-05,-3.701e-05,-1.112e-04,
        -1.797e-04,-2.354e-04,-2.718e-04,-2.836e-04,-2.674e-04,-2.22e-04,-1.493e-04,-5.392e-05,5.656e-05,1.723e-04,
        2.818e-04,3.73e-04,4.345e-04,4.566e-04,4.329e-04,3.61e-04,2.435e-04,8.816e-05,-9.259e-05,-2.822e-04,
        -4.614e-04,-6.101e-04,-7.095e-04,-7.441e-04,-7.036e-04,-5.852e-04,-3.935e-04,-1.42e-04,1.486e-04,4.511e-04,
        7.347e-04,9.677e-04,1.121e-03,1.171e-03,1.102e-03,9.13e-04,6.114e-04,2.197e-04,-2.29e-04,-6.924e-04,
        -1.123e-03,-1.474e-03,-1.7e-03,-1.769e-03,-1.66e-03,-1.37e-03,-9.14e-04,-3.273e-04,3.4e-04,1.025e-03,
        1.657e-03,2.168e-03,2.494e-03,2.588e-03,2.422e-03,1.994e-03,1.327e-03,4.743e-04,-4.917e-04,-1.479e-03,
        -2.388e-03,-3.118e-03,-3.581e-03,-3.711e-03,-3.469e-03,-2.852e-03,-1.897e-03,-6.773e-04,7.017e-04,2.11e-03,
        3.405e-03,4.446e-03,5.108e-03,5.294e-03,4.951e-03,4.074e-03,2.713e-03,9.695e-04,-1.006e-03,-3.03e-03,
        -4.9e-03,-6.413e-03,-7.387e-03,-7.68e-03,-7.206e-03,-5.952e-03,-3.979e-03,-1.429e-03,1.49e-03,4.514e-03,
        7.346e-03,9.68e-03,1.123e-02,1.178e-02,1.115e-02,9.305e-03,6.291e-03,2.287e-03,-2.418e-03,-7.437e-03,
        -1.231e-02,-1.653e-02,-1.959e-02,-2.103e-02,-2.046e-02,-1.76e-02,-1.232e-02,-4.665e-03,5.171e-03,1.681e-02,
        2.975e-02,4.333e-02,5.687e-02,6.96e-02,8.082e-02,8.987e-02,9.622e-02,9.949e-02
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_8M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.9e-04,1.38e-04,5.082e-05,-5.167e-05,-1.451e-04,-2.063e-04,-2.188e-04,-1.767e-04,-8.719e-05,3.073e-05,
        1.495e-04,2.393e-04,2.75e-04,2.427e-04,1.447e-04,0.0,-1.586e-04,-2.913e-04,-3.612e-04,-3.438e-04,
        -2.345e-04,-5.253e-05,1.621e-04,3.566e-04,4.777e-04,4.86e-04,3.676e-04,1.403e-04,-1.474e-04,-4.259e-04,
        -6.212e-04,-6.733e-04,-5.541e-04,-2.776e-04,9.908e-05,4.869e-04,7.851e-04,9.067e-04,8.028e-04,4.792e-04,
        0.0,-5.238e-04,-9.591e-04,-1.184e-03,-1.121e-03,-7.597e-04,-1.69e-04,5.175e-04,1.129e-03,1.5e-03,
        1.512e-03,1.133e-03,4.285e-04,-4.458e-04,-1.276e-03,-1.844e-03,-1.98e-03,-1.614e-03,-8.01e-04,2.832e-04,
        1.379e-03,2.204e-03,2.523e-03,2.215e-03,1.311e-03,0.0,-1.41e-03,-2.562e-03,-3.14e-03,-2.951e-03,
        -1.987e-03,-4.39e-04,1.336e-03,2.898e-03,3.828e-03,3.84e-03,2.864e-03,1.078e-03,-1.117e-03,-3.185e-03,
        -4.585e-03,-4.907e-03,-3.989e-03,-1.975e-03,6.972e-04,3.39e-03,5.412e-03,6.192e-03,5.435e-03,3.219e-03,
        0.0,-3.471e-03,-6.322e-03,-7.768e-03,-7.325e-03,-4.952e-03,-1.1e-03,3.366e-03,7.348e-03,9.777e-03,
        9.89e-03,7.445e-03,2.832e-03,-2.969e-03,-8.577e-03,-1.253e-02,-1.363e-02,-1.128e-02,-5.696e-03,2.055e-03,
        1.024e-02,1.68e-02,1.982e-02,1.8e-02,1.107e-02,0.0,-1.309e-02,-2.521e-02,-3.302e-02,-3.355e-02,
        -2.475e-02,-6.102e-03,2.122e-02,5.435e-02,8.919e-02,.121,.1452,.1583
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_10M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.998e-04,-1.632e-04,-6.315e-05,6.421e-05,1.715e-04,2.17e-04,1.802e-04,7.089e-05,-7.32e-05,-1.984e-04,
        -2.544e-04,-2.14e-04,-8.515e-05,8.884e-05,2.43e-04,3.143e-04,2.663e-04,1.066e-04,-1.119e-04,-3.074e-04,
        -3.99e-04,-3.391e-04,-1.361e-04,1.43e-04,3.935e-04,5.111e-04,4.345e-04,1.743e-04,-1.831e-04,-5.034e-04,
        -6.533e-04,-5.546e-04,-2.222e-04,2.331e-04,6.396e-04,8.285e-04,7.021e-04,2.808e-04,-2.939e-04,-8.048e-04,
        -1.04e-03,-8.797e-04,-3.511e-04,3.667e-04,1.002e-03,1.293e-03,1.091e-03,4.345e-04,-4.528e-04,-1.235e-03,
        -1.59e-03,-1.34e-03,-5.325e-04,5.541e-04,1.509e-03,1.939e-03,1.631e-03,6.473e-04,-6.725e-04,-1.828e-03,
        -2.347e-03,-1.971e-03,-7.813e-04,8.107e-04,2.202e-03,2.823e-03,2.368e-03,9.38e-04,-9.724e-04,-2.639e-03,
        -3.381e-03,-2.834e-03,-1.122e-03,1.162e-03,3.153e-03,4.038e-03,3.385e-03,1.339e-03,-1.388e-03,-3.764e-03,
        -4.821e-03,-4.042e-03,-1.6e-03,1.658e-03,4.501e-03,5.768e-03,4.839e-03,1.917e-03,-1.99e-03,-5.406e-03,
        -6.938e-03,-5.83e-03,-2.314e-03,2.406e-03,6.551e-03,8.427e-03,7.1e-03,2.826e-03,-2.947e-03,-8.054e-03,
        -1.04e-02,-8.8e-03,-3.519e-03,3.689e-03,1.014e-02,1.317e-02,1.122e-02,4.523e-03,-4.782e-03,-1.327e-02,
        -1.743e-02,-1.502e-02,-6.137e-03,6.588e-03,1.86e-02,2.492e-02,2.199e-02,9.226e-03,-1.023e-02,-3.e-02,
        -4.212e-02,-3.939e-02,-1.781e-02,2.18e-02,7.346e-02,.1272,.1717,.1968
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_12M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.899e-04,1.824e-04,7.519e-05,-7.645e-05,-1.917e-04,-2.062e-04,-1.073e-04,5.702e-05,1.999e-04,2.407e-04,
        1.495e-04,-3.314e-05,-2.122e-04,-2.868e-04,-2.055e-04,0.0,2.252e-04,3.442e-04,2.788e-04,4.76e-05,
        -2.344e-04,-4.115e-04,-3.717e-04,-1.15e-04,2.342e-04,4.858e-04,4.857e-04,2.076e-04,-2.18e-04,-5.628e-04,
        -6.209e-04,-3.301e-04,1.788e-04,6.365e-04,7.762e-04,4.867e-04,-1.087e-04,-6.997e-04,-9.486e-04,-6.806e-04,
        0.0,7.44e-04,1.133e-03,9.138e-04,1.552e-04,-7.594e-04,-1.324e-03,-1.186e-03,-3.642e-04,7.352e-04,
        1.512e-03,1.497e-03,6.341e-04,-6.597e-04,-1.687e-03,-1.843e-03,-9.706e-04,5.206e-04,1.836e-03,2.219e-03,
        1.379e-03,-3.052e-04,-1.947e-03,-2.617e-03,-1.862e-03,0.0,2.003e-03,3.028e-03,2.423e-03,4.086e-04,
        -1.986e-03,-3.44e-03,-3.064e-03,-9.35e-04,1.877e-03,3.838e-03,3.783e-03,1.595e-03,-1.652e-03,-4.208e-03,
        -4.583e-03,-2.406e-03,1.287e-03,4.529e-03,5.462e-03,3.389e-03,-7.493e-04,-4.779e-03,-6.422e-03,-4.572e-03,
        0.0,4.93e-03,7.469e-03,5.995e-03,1.014e-03,-4.95e-03,-8.616e-03,-7.717e-03,-2.371e-03,4.793e-03,
        9.886e-03,9.837e-03,4.19e-03,-4.392e-03,-1.133e-02,-1.252e-02,-6.68e-03,3.638e-03,1.306e-02,1.61e-02,
        1.024e-02,-2.326e-03,-1.529e-02,-2.127e-02,-1.573e-02,0.0,1.859e-02,2.978e-02,2.548e-02,4.645e-03,
        -2.474e-02,-4.78e-02,-4.864e-02,-1.754e-02,4.372e-02,.1209,.1919,.2343
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_15M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.412e-04,-3.155e-05,-1.821e-04,-1.851e-04,-3.316e-05,1.534e-04,2.2e-04,1.041e-04,-1.075e-04,-2.422e-04,
        -1.799e-04,4.138e-05,2.455e-04,2.562e-04,4.699e-05,-2.222e-04,-3.251e-04,-1.567e-04,1.643e-04,3.753e-04,
        2.821e-04,-6.557e-05,-3.924e-04,-4.124e-04,-7.608e-05,3.614e-04,5.304e-04,2.561e-04,-2.69e-04,-6.146e-04,
        -4.619e-04,1.072e-04,6.408e-04,6.72e-04,1.237e-04,-5.858e-04,-8.571e-04,-4.125e-04,4.317e-04,9.825e-04,
        7.356e-04,-1.701e-04,-1.012e-03,-1.057e-03,-1.938e-04,9.14e-04,1.332e-03,6.383e-04,-6.653e-04,-1.508e-03,
        -1.124e-03,2.59e-04,1.535e-03,1.598e-03,2.917e-04,-1.371e-03,-1.991e-03,-9.509e-04,9.879e-04,2.232e-03,
        1.659e-03,-3.811e-04,-2.253e-03,-2.337e-03,-4.257e-04,1.996e-03,2.891e-03,1.378e-03,-1.428e-03,-3.221e-03,
        -2.39e-03,5.48e-04,3.235e-03,3.351e-03,6.097e-04,-2.855e-03,-4.132e-03,-1.968e-03,2.039e-03,4.595e-03,
        3.409e-03,-7.815e-04,-4.613e-03,-4.781e-03,-8.702e-04,4.078e-03,5.908e-03,2.817e-03,-2.923e-03,-6.6e-03,
        -4.906e-03,1.127e-03,6.672e-03,6.936e-03,1.267e-03,-5.958e-03,-8.667e-03,-4.152e-03,4.33e-03,9.832e-03,
        7.354e-03,-1.701e-03,-1.015e-02,-1.064e-02,-1.96e-03,9.316e-03,1.37e-02,6.645e-03,-7.026e-03,-1.62e-02,
        -1.232e-02,2.905e-03,1.769e-02,1.899e-02,3.596e-03,-1.762e-02,-2.684e-02,-1.355e-02,1.502e-02,3.662e-02,
        2.978e-02,-7.617e-03,-5.136e-02,-6.286e-02,-1.42e-02,8.997e-02,.2096,.289
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_18M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -6.174e-05,-2.001e-04,-1.095e-04,1.114e-04,2.104e-04,6.706e-05,-1.624e-04,-2.133e-04,-1.488e-05,2.149e-04,
        2.059e-04,-4.957e-05,-2.669e-04,-1.833e-04,1.279e-04,3.144e-04,1.402e-04,-2.2e-04,-3.507e-04,-7.121e-05,
        3.229e-04,3.674e-04,-2.766e-05,-4.304e-04,-3.546e-04,1.58e-04,5.329e-04,3.024e-04,-3.176e-04,-6.175e-04,
        -2.019e-04,4.998e-04,6.688e-04,4.737e-05,-6.93e-04,-6.704e-04,1.626e-04,8.802e-04,6.063e-04,-4.237e-04,
        -1.04e-03,-4.631e-04,7.243e-04,1.149e-03,2.321e-04,-1.046e-03,-1.182e-03,8.829e-05,1.363e-03,1.113e-03,
        -4.915e-04,-1.643e-03,-9.236e-04,9.609e-04,1.851e-03,5.993e-04,-1.47e-03,-1.948e-03,-1.367e-04,1.981e-03,
        1.899e-03,-4.566e-04,-2.449e-03,-1.673e-03,1.159e-03,2.823e-03,1.247e-03,-1.935e-03,-3.048e-03,-6.113e-04,
        2.735e-03,3.071e-03,-2.28e-04,-3.498e-03,-2.842e-03,1.248e-03,4.151e-03,2.323e-03,-2.407e-03,-4.617e-03,
        -1.49e-03,3.642e-03,4.815e-03,3.37e-04,-4.876e-03,-4.667e-03,1.121e-03,6.011e-03,4.105e-03,-2.846e-03,
        -6.939e-03,-3.069e-03,4.774e-03,7.541e-03,1.517e-03,-6.819e-03,-7.691e-03,5.743e-04,8.869e-03,7.258e-03,
        -3.215e-03,-1.079e-02,-6.103e-03,6.398e-03,1.244e-02,4.072e-03,-1.012e-02,-1.361e-02,-9.719e-04,1.437e-02,
        1.41e-02,-3.481e-03,-1.924e-02,-1.359e-02,9.79e-03,2.492e-02,1.157e-02,-1.903e-02,-3.206e-02,-6.949e-03,
        3.408e-02,4.268e-02,-3.62e-03,-6.561e-02,-6.621e-02,3.933e-02,.2105,.3412
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_20M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        0.0,1.917e-04,1.201e-04,-1.221e-04,-2.015e-04,0.0,2.118e-04,1.348e-04,-1.392e-04,-2.331e-04,
        0.0,2.515e-04,1.619e-04,-1.689e-04,-2.856e-04,0.0,3.129e-04,2.027e-04,-2.127e-04,-3.612e-04,
        0.0,3.985e-04,2.588e-04,-2.719e-04,-4.624e-04,0.0,5.105e-04,3.315e-04,-3.482e-04,-5.915e-04,
        0.0,6.517e-04,4.225e-04,-4.431e-04,-7.516e-04,0.0,8.25e-04,5.338e-04,-5.587e-04,-9.457e-04,
        0.0,1.034e-03,6.675e-04,-6.971e-04,-1.178e-03,0.0,1.282e-03,8.26e-04,-8.61e-04,-1.451e-03,
        0.0,1.574e-03,1.012e-03,-1.053e-03,-1.773e-03,0.0,1.916e-03,1.231e-03,-1.278e-03,-2.149e-03,
        0.0,2.316e-03,1.485e-03,-1.541e-03,-2.587e-03,0.0,2.783e-03,1.783e-03,-1.849e-03,-3.101e-03,
        0.0,3.33e-03,2.133e-03,-2.21e-03,-3.705e-03,0.0,3.977e-03,2.547e-03,-2.638e-03,-4.423e-03,
        0.0,4.749e-03,3.042e-03,-3.153e-03,-5.288e-03,0.0,5.686e-03,3.646e-03,-3.783e-03,-6.352e-03,
        0.0,6.85e-03,4.399e-03,-4.574e-03,-7.697e-03,0.0,8.342e-03,5.373e-03,-5.603e-03,-9.463e-03,
        0.0,1.034e-02,6.691e-03,-7.014e-03,-1.191e-02,0.0,1.319e-02,8.6e-03,-9.093e-03,-1.559e-02,
        0.0,1.765e-02,1.167e-02,-1.253e-02,-2.185e-02,0.0,2.583e-02,1.754e-02,-1.944e-02,-3.525e-02,
        0.0,4.629e-02,3.387e-02,-4.145e-02,-8.632e-02,0.0,.2017,.3741
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_22M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        6.173e-05,-1.767e-04,-1.303e-04,1.324e-04,1.858e-04,-6.705e-05,-2.21e-04,-1.44e-05,2.294e-04,1.044e-04,
        -2.058e-04,-1.928e-04,1.476e-04,2.673e-04,-5.629e-05,-3.143e-04,-6.168e-05,3.208e-04,1.94e-04,-2.77e-04,
        -3.228e-04,1.785e-04,4.266e-04,-2.906e-05,-4.825e-04,-1.579e-04,4.706e-04,3.596e-04,-3.777e-04,-5.453e-04,
        2.019e-04,6.801e-04,4.516e-05,-7.305e-04,-3.366e-04,6.703e-04,6.326e-04,-4.869e-04,-8.842e-04,1.864e-04,
        1.04e-03,2.038e-04,-1.056e-03,-6.358e-04,9.03e-04,1.046e-03,-5.741e-04,-1.362e-03,9.201e-05,1.515e-03,
        4.914e-04,-1.451e-03,-1.098e-03,1.143e-03,1.634e-03,-5.992e-04,-2.e-03,-1.315e-04,2.108e-03,9.623e-04,
        -1.899e-03,-1.776e-03,1.355e-03,2.439e-03,-5.1e-04,-2.823e-03,-5.485e-04,2.822e-03,1.686e-03,-2.378e-03,
        -2.735e-03,1.492e-03,3.516e-03,-2.362e-04,-3.867e-03,-1.248e-03,3.666e-03,2.763e-03,-2.862e-03,-4.077e-03,
        1.49e-03,4.956e-03,3.251e-04,-5.198e-03,-2.369e-03,4.666e-03,4.361e-03,-3.325e-03,-5.986e-03,1.252e-03,
        6.938e-03,1.35e-03,-6.962e-03,-4.171e-03,5.902e-03,6.817e-03,-3.736e-03,-8.858e-03,5.988e-04,9.876e-03,
        3.214e-03,-9.531e-03,-7.259e-03,7.61e-03,1.098e-02,-4.071e-03,-1.376e-02,-9.191e-04,1.499e-02,6.983e-03,
        -1.41e-02,-1.354e-02,1.064e-02,1.982e-02,-4.307e-03,-2.492e-02,-5.092e-03,2.776e-02,1.773e-02,-2.703e-02,
        -3.407e-02,2.073e-02,5.583e-02,-4.43e-03,-9.009e-02,-3.932e-02,.1859,.4059
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_25M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.413e-04,-1.426e-04,1.445e-04,1.469e-04,-1.499e-04,-1.534e-04,1.575e-04,1.622e-04,-1.675e-04,-1.734e-04,
        1.799e-04,1.871e-04,-1.949e-04,-2.033e-04,2.124e-04,2.223e-04,-2.328e-04,-2.44e-04,2.56e-04,2.687e-04,
        -2.822e-04,-2.964e-04,3.115e-04,3.273e-04,-3.439e-04,-3.614e-04,3.798e-04,3.99e-04,-4.191e-04,-4.401e-04,
        4.62e-04,4.848e-04,-5.086e-04,-5.334e-04,5.591e-04,5.859e-04,-6.137e-04,-6.426e-04,6.725e-04,7.035e-04,
        -7.357e-04,-7.69e-04,8.034e-04,8.391e-04,-8.76e-04,-9.141e-04,9.535e-04,9.942e-04,-1.036e-03,-1.08e-03,
        1.125e-03,1.171e-03,-1.219e-03,-1.268e-03,1.319e-03,1.371e-03,-1.425e-03,-1.481e-03,1.539e-03,1.598e-03,
        -1.66e-03,-1.723e-03,1.788e-03,1.855e-03,-1.925e-03,-1.996e-03,2.07e-03,2.146e-03,-2.225e-03,-2.307e-03,
        2.391e-03,2.478e-03,-2.567e-03,-2.66e-03,2.756e-03,2.856e-03,-2.959e-03,-3.065e-03,3.176e-03,3.29e-03,
        -3.409e-03,-3.533e-03,3.661e-03,3.795e-03,-3.934e-03,-4.079e-03,4.23e-03,4.388e-03,-4.553e-03,-4.726e-03,
        4.906e-03,5.096e-03,-5.295e-03,-5.505e-03,5.726e-03,5.959e-03,-6.206e-03,-6.467e-03,6.745e-03,7.04e-03,
        -7.355e-03,-7.692e-03,8.053e-03,8.442e-03,-8.862e-03,-9.317e-03,9.811e-03,1.035e-02,-1.094e-02,-1.16e-02,
        1.232e-02,1.313e-02,-1.404e-02,-1.508e-02,1.626e-02,1.762e-02,-1.922e-02,-2.111e-02,2.34e-02,2.622e-02,
        -2.978e-02,-3.443e-02,4.076e-02,4.989e-02,-6.422e-02,-8.998e-02,.15,.4503
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_28M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.9e-04,9.716e-05,1.575e-04,-1.601e-04,-1.021e-04,2.063e-04,2.792e-05,-2.289e-04,5.89e-05,2.218e-04,
        -1.495e-04,-1.811e-04,2.326e-04,1.058e-04,-2.951e-04,0.0,3.233e-04,-1.27e-04,-3.056e-04,2.601e-04,
        2.345e-04,-3.793e-04,-1.095e-04,4.619e-04,-6.096e-05,-4.861e-04,2.587e-04,4.347e-04,-4.566e-04,-2.998e-04,
        6.212e-04,8.592e-05,-7.177e-04,1.876e-04,7.154e-04,-4.87e-04,-5.94e-04,7.671e-04,3.501e-04,-9.772e-04,
        0.0,1.068e-03,-4.182e-04,-1.002e-03,8.479e-04,7.597e-04,-1.22e-03,-3.496e-04,1.462e-03,-1.914e-04,
        -1.512e-03,7.976e-04,1.328e-03,-1.381e-03,-8.984e-04,1.844e-03,2.526e-04,-2.09e-03,5.412e-04,2.045e-03,
        -1.379e-03,-1.668e-03,2.135e-03,9.657e-04,-2.673e-03,0.0,2.875e-03,-1.117e-03,-2.657e-03,2.233e-03,
        1.987e-03,-3.17e-03,-9.028e-04,3.754e-03,-4.885e-04,-3.84e-03,2.015e-03,3.34e-03,-3.46e-03,-2.241e-03,
        4.585e-03,6.261e-04,-5.167e-03,1.335e-03,5.033e-03,-3.39e-03,-4.095e-03,5.239e-03,2.37e-03,-6.564e-03,
        0.0,7.078e-03,-2.756e-03,-6.572e-03,5.542e-03,4.953e-03,-7.94e-03,-2.274e-03,9.518e-03,-1.248e-03,
        -9.891e-03,5.24e-03,8.774e-03,-9.198e-03,-6.037e-03,1.253e-02,1.739e-03,-1.461e-02,3.849e-03,1.484e-02,
        -1.024e-02,-1.271e-02,1.677e-02,7.848e-03,-2.258e-02,0.0,2.669e-02,-1.099e-02,-2.794e-02,2.538e-02,
        2.475e-02,-4.406e-02,-1.433e-02,7.041e-02,-1.138e-02,-.121,.1022,.4906
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_30M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        1.997e-04,-6.23e-05,-1.653e-04,1.68e-04,6.548e-05,-2.169e-04,6.881e-05,1.855e-04,-1.916e-04,-7.574e-05,
        2.543e-04,-8.171e-05,-2.228e-04,2.325e-04,9.28e-05,-3.142e-04,1.017e-04,2.791e-04,-2.928e-04,-1.174e-04,
        3.989e-04,-1.295e-04,-3.562e-04,3.743e-04,1.502e-04,-5.109e-04,1.659e-04,4.563e-04,-4.792e-04,-1.922e-04,
        6.53e-04,-2.118e-04,-5.816e-04,6.099e-04,2.442e-04,-8.282e-04,2.681e-04,7.348e-04,-7.69e-04,-3.073e-04,
        1.04e-03,-3.359e-04,-9.188e-04,9.596e-04,3.826e-04,-1.292e-03,4.165e-04,1.137e-03,-1.185e-03,-4.716e-04,
        1.59e-03,-5.115e-04,-1.394e-03,1.45e-03,5.761e-04,-1.938e-03,6.226e-04,1.694e-03,-1.76e-03,-6.981e-04,
        2.346e-03,-7.525e-04,-2.045e-03,2.122e-03,8.407e-04,-2.822e-03,9.043e-04,2.455e-03,-2.545e-03,-1.008e-03,
        3.379e-03,-1.082e-03,-2.936e-03,3.042e-03,1.204e-03,-4.036e-03,1.292e-03,3.505e-03,-3.632e-03,-1.437e-03,
        4.819e-03,-1.543e-03,-4.187e-03,4.34e-03,1.718e-03,-5.766e-03,1.848e-03,5.018e-03,-5.207e-03,-2.064e-03,
        6.935e-03,-2.226e-03,-6.056e-03,6.295e-03,2.501e-03,-8.423e-03,2.711e-03,7.396e-03,-7.713e-03,-3.075e-03,
        1.04e-02,-3.36e-03,-9.21e-03,9.654e-03,3.871e-03,-1.317e-02,4.286e-03,1.184e-02,-1.252e-02,-5.066e-03,
        1.742e-02,-5.737e-03,-1.606e-02,1.724e-02,7.101e-03,-2.491e-02,8.395e-03,2.415e-02,-2.676e-02,-1.145e-02,
        4.21e-02,-1.504e-02,-4.661e-02,5.705e-02,2.805e-02,-.1272,6.554e-02,.5149
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_32M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.9e-04,2.528e-05,1.726e-04,-1.754e-04,-2.657e-05,2.064e-04,-1.525e-04,-8.445e-05,2.364e-04,-1.181e-04,
        -1.495e-04,2.598e-04,-6.853e-05,-2.215e-04,2.718e-04,0.0,-2.979e-04,2.659e-04,9.003e-05,-3.733e-04,
        2.346e-04,2.019e-04,-4.396e-04,1.704e-04,3.33e-04,-4.861e-04,6.731e-05,4.764e-04,-5.004e-04,-7.799e-05,
        6.213e-04,-4.693e-04,-2.648e-04,7.528e-04,-3.809e-04,-4.87e-04,8.525e-04,-2.26e-04,-7.328e-04,9.002e-04,
        0.0,-9.839e-04,8.754e-04,2.951e-04,-1.217e-03,7.598e-04,6.496e-04,-1.403e-03,5.395e-04,1.045e-03,
        -1.513e-03,2.075e-04,1.455e-03,-1.514e-03,-2.337e-04,1.844e-03,-1.38e-03,-7.711e-04,2.172e-03,-1.089e-03,
        -1.379e-03,2.393e-03,-6.288e-04,-2.021e-03,2.463e-03,0.0,-2.649e-03,2.339e-03,7.826e-04,-3.204e-03,
        1.987e-03,1.688e-03,-3.623e-03,1.385e-03,2.668e-03,-3.841e-03,5.244e-04,3.66e-03,-3.792e-03,-5.832e-04,
        4.585e-03,-3.42e-03,-1.906e-03,5.356e-03,-2.68e-03,-3.391e-03,5.876e-03,-1.543e-03,-4.961e-03,6.047e-03,
        0.0,-6.521e-03,5.77e-03,1.936e-03,-7.954e-03,4.953e-03,4.228e-03,-9.127e-03,3.511e-03,6.815e-03,
        -9.892e-03,1.363e-03,9.616e-03,-1.008e-02,-1.571e-03,1.253e-02,-9.498e-03,-5.389e-03,1.545e-02,-7.901e-03,
        -1.024e-02,1.824e-02,-4.939e-03,-1.643e-02,2.08e-02,0.0,-2.459e-02,2.301e-02,8.23e-03,-3.642e-02,
        2.476e-02,2.346e-02,-5.753e-02,2.597e-02,6.216e-02,-.121,2.659e-02,.5376
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_35M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        -1.412e-04,1.992e-04,-9.277e-05,-9.432e-05,2.094e-04,-1.534e-04,-3.485e-05,2.044e-04,-2.11e-04,3.835e-05,
        1.799e-04,-2.612e-04,1.251e-04,1.305e-04,-2.967e-04,2.222e-04,5.149e-05,-3.074e-04,3.225e-04,-5.943e-05,
        -2.821e-04,4.14e-04,-1.999e-04,-2.101e-04,4.803e-04,-3.614e-04,-8.4e-05,5.026e-04,-5.279e-04,9.733e-05,
        4.619e-04,-6.77e-04,3.265e-04,3.424e-04,-7.808e-04,5.858e-04,1.357e-04,-8.095e-04,8.472e-04,-1.556e-04,
        -7.355e-04,1.074e-03,-5.157e-04,-5.386e-04,1.223e-03,-9.139e-04,-2.109e-04,1.253e-03,-1.306e-03,2.388e-04,
        1.124e-03,-1.635e-03,7.823e-04,8.139e-04,-1.842e-03,1.371e-03,3.153e-04,-1.866e-03,1.939e-03,-3.535e-04,
        -1.659e-03,2.406e-03,-1.148e-03,-1.191e-03,2.688e-03,-1.996e-03,-4.579e-04,2.704e-03,-2.803e-03,5.102e-04,
        2.39e-03,-3.46e-03,1.648e-03,1.708e-03,-3.849e-03,2.855e-03,6.544e-04,-3.862e-03,4.001e-03,-7.278e-04,
        -3.409e-03,4.934e-03,-2.35e-03,-2.436e-03,5.494e-03,-4.078e-03,-9.357e-04,5.528e-03,-5.736e-03,1.045e-03,
        4.905e-03,-7.117e-03,3.399e-03,3.534e-03,-7.996e-03,5.958e-03,1.373e-03,-8.147e-03,8.497e-03,-1.557e-03,
        -7.353e-03,1.074e-02,-5.17e-03,-5.419e-03,1.238e-02,-9.315e-03,-2.17e-03,1.304e-02,-1.379e-02,2.565e-03,
        1.232e-02,-1.834e-02,9.015e-03,9.677e-03,-2.27e-02,1.762e-02,4.251e-03,-2.66e-02,2.948e-02,-5.8e-03,
        -2.978e-02,4.809e-02,-2.617e-02,-3.202e-02,8.968e-02,-8.996e-02,-3.319e-02,.5673
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_38M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        6.171e-05,8.585e-05,-1.899e-04,1.931e-04,-9.023e-05,-6.703e-05,1.952e-04,-2.221e-04,1.269e-04,4.593e-05,
        -2.058e-04,2.623e-04,-1.756e-04,-1.805e-05,2.189e-04,-3.142e-04,2.399e-04,-2.166e-05,-2.307e-04,3.769e-04,
        -3.227e-04,7.852e-05,2.359e-04,-4.481e-04,4.261e-04,-1.579e-04,-2.286e-04,5.244e-04,-5.508e-04,2.649e-04,
        2.018e-04,-6.006e-04,6.964e-04,-4.04e-04,-1.481e-04,6.701e-04,-8.607e-04,5.79e-04,5.969e-05,-7.25e-04,
        1.04e-03,-7.924e-04,7.131e-05,7.561e-04,-1.229e-03,1.045e-03,-2.526e-04,-7.531e-04,1.419e-03,-1.338e-03,
        4.913e-04,7.048e-04,-1.602e-03,1.667e-03,-7.938e-04,-5.99e-04,1.766e-03,-2.028e-03,1.166e-03,4.234e-04,
        -1.898e-03,2.416e-03,-1.611e-03,-1.647e-04,1.983e-03,-2.822e-03,2.133e-03,-1.905e-04,-2.005e-03,3.235e-03,
        -2.734e-03,6.563e-04,1.945e-03,-3.642e-03,3.414e-03,-1.247e-03,-1.781e-03,4.029e-03,-4.174e-03,1.98e-03,
        1.489e-03,-4.377e-03,5.013e-03,-2.875e-03,-1.042e-03,4.665e-03,-5.933e-03,3.954e-03,4.041e-04,-4.87e-03,
        6.936e-03,-5.251e-03,4.7e-04,4.96e-03,-8.03e-03,6.815e-03,-1.644e-03,-4.899e-03,9.235e-03,-8.721e-03,
        3.213e-03,4.63e-03,-1.059e-02,1.11e-02,-5.334e-03,-4.07e-03,1.215e-02,-1.417e-02,8.29e-03,3.072e-03,
        -1.409e-02,1.842e-02,-1.265e-02,-1.338e-03,1.675e-02,-2.491e-02,1.98e-02,-1.874e-03,-2.109e-02,3.677e-02,
        -3.406e-02,9.121e-03,3.088e-02,-6.831e-02,7.955e-02,-3.931e-02,-9.031e-02,.5918
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}

float Fir::DigFil_lp_40M(float invar, float initval, int setic)
{
    float sumnum=0.0; int i=0;
    static float states[255] = {
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,
        0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0
    };
    static float znum[128] = {
        0.0,-1.185e-04,1.943e-04,-1.976e-04,1.246e-04,0.0,-1.309e-04,2.181e-04,-2.252e-04,1.441e-04,
        0.0,-1.555e-04,2.62e-04,-2.734e-04,1.766e-04,0.0,-1.935e-04,3.281e-04,-3.442e-04,2.233e-04,
        0.0,-2.464e-04,4.188e-04,-4.401e-04,2.858e-04,0.0,-3.156e-04,5.365e-04,-5.635e-04,3.657e-04,
        0.0,-4.029e-04,6.839e-04,-7.172e-04,4.647e-04,0.0,-5.1e-04,8.64e-04,-9.043e-04,5.847e-04,
        0.0,-6.391e-04,1.08e-03,-1.128e-03,7.28e-04,0.0,-7.924e-04,1.337e-03,-1.394e-03,8.974e-04,
        0.0,-9.731e-04,1.639e-03,-1.705e-03,1.096e-03,0.0,-1.185e-03,1.992e-03,-2.069e-03,1.328e-03,
        0.0,-1.432e-03,2.404e-03,-2.495e-03,1.6e-03,0.0,-1.72e-03,2.886e-03,-2.992e-03,1.917e-03,
        0.0,-2.059e-03,3.452e-03,-3.577e-03,2.291e-03,0.0,-2.459e-03,4.122e-03,-4.27e-03,2.735e-03,
        0.0,-2.936e-03,4.924e-03,-5.103e-03,3.27e-03,0.0,-3.516e-03,5.901e-03,-6.122e-03,3.927e-03,
        0.0,-4.235e-03,7.121e-03,-7.403e-03,4.759e-03,0.0,-5.157e-03,8.696e-03,-9.07e-03,5.851e-03,
        0.0,-6.393e-03,1.083e-02,-1.135e-02,7.365e-03,0.0,-8.154e-03,1.392e-02,-1.472e-02,9.639e-03,
        0.0,-1.091e-02,1.888e-02,-2.027e-02,1.351e-02,0.0,-1.597e-02,2.839e-02,-3.147e-02,2.179e-02,
        0.0,-2.862e-02,5.481e-02,-6.709e-02,5.337e-02,0.0,-.1247,.6055
    };
    if (setic==1){
        for (i=0;i<255;i++) states[i] = initval;
        return initval;
    }
    else{
        for (i=0;i<255;i++){
            sumnum += states[i]*znum[i<128?i:255-i];
            if (i<254) states[i] = states[i+1];
        }
        states[254] = invar;
        sumnum += states[254]*znum[0];
        return sumnum;
    }
}
